<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>D365 Modern Shell - Demo</title>
    <style>
        /* =============================================================================
           RESET
           ============================================================================= */
        *,
        *::before,
        *::after {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        ul, ol { list-style: none; }
        a { text-decoration: none; color: inherit; }
        button { font-family: inherit; cursor: pointer; }

        /* =============================================================================
           GENERIC D365 SHELL – THEME SYSTEM v1.2
           Supports: theme-dark (Circuit), theme-light (Circuit), theme-d365 (Microsoft)
           ============================================================================= */

        /* ─── Circuit Dark ─── */
        body.theme-dark {
            --bg-primary: #0B0D10;
            --bg-secondary: #12161C;
            --bg-tertiary: #1A1F26;
            --border-subtle: #232A33;
            --border-strong: #2E3742;
            --text-primary: #E6EDF3;
            --text-secondary: #C9D1D9;
            --text-muted: #8B949E;
            --color-primary: #1E88E5;
            --color-secondary: #43A047;
            --color-accent: #00BCD4;
            --color-danger: #E53935;
            --color-warning: #F2C94C;
            --color-success: #4CAF50;
            --shadow-card: 0 8px 24px rgba(0,0,0,0.45);
            --shadow-modal: 0 16px 48px rgba(0,0,0,0.6);
        }

        /* ─── Circuit Light ─── */
        body.theme-light {
            --bg-primary: #F4F7FA;
            --bg-secondary: #FFFFFF;
            --bg-tertiary: #E9EEF3;
            --border-subtle: #D0D7DE;
            --border-strong: #B6C2CF;
            --text-primary: #0D1117;
            --text-secondary: #30363D;
            --text-muted: #57606A;
            --color-primary: #1565C0;
            --color-secondary: #2E7D32;
            --color-accent: #00897B;
            --color-danger: #C62828;
            --color-warning: #D4AF37;
            --color-success: #388E3C;
            --shadow-card: 0 6px 18px rgba(0,0,0,0.08);
            --shadow-modal: 0 12px 32px rgba(0,0,0,0.12);
        }

        /* ─── Dynamics 365 ─── */
        body.theme-d365 {
            --bg-primary: #F3F2F1;
            --bg-secondary: #FFFFFF;
            --bg-tertiary: #FAF9F8;
            --border-subtle: #E1DFDD;
            --border-strong: #C8C6C4;
            --text-primary: #323130;
            --text-secondary: #605E5C;
            --text-muted: #8A8886;
            --color-primary: #0078D4;
            --color-primary-hover: #106EBE;
            --color-primary-active: #005A9E;
            --color-secondary: #107C10;
            --color-accent: #00B7C3;
            --color-danger: #D13438;
            --color-warning: #FFB900;
            --color-success: #107C10;
            --shadow-card: 0 2px 6px rgba(0,0,0,0.08);
            --shadow-modal: 0 8px 24px rgba(0,0,0,0.2);
        }

        /* =============================================================================
           BASE
           ============================================================================= */
        body {
            font-family: 'Segoe UI Variable', 'Segoe UI', -apple-system, BlinkMacSystemFont, system-ui, sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            height: 100vh;
            overflow: hidden;
            background-color: var(--bg-primary);
            color: var(--text-primary);
            font-size: 14px;
            line-height: 1.5;
        }

        /* =============================================================================
           TOPBAR — 48px fixed header
           ============================================================================= */
        .top-bar {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: 48px;
            background-color: var(--bg-secondary);
            border-bottom: 1px solid var(--border-subtle);
            display: flex;
            align-items: center;
            padding: 0 16px;
            z-index: 1000;
        }

        .top-bar-left {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .top-bar-title {
            font-size: 16px;
            font-weight: 600;
            color: var(--text-primary);
            white-space: nowrap;
        }

        .top-bar-center {
            flex: 1;
            display: flex;
            justify-content: center;
            padding: 0 24px;
        }

        .top-bar-search {
            width: 100%;
            max-width: 400px;
            padding: 6px 12px 6px 32px;
            font-size: 13px;
            font-family: inherit;
            border: 1px solid var(--border-subtle);
            border-radius: 4px;
            background-color: var(--bg-primary);
            color: var(--text-primary);
            outline: none;
            transition: border-color 150ms ease-in-out;
        }

        .top-bar-search::placeholder {
            color: var(--text-muted);
        }

        .top-bar-search:focus {
            border-color: var(--color-primary);
        }

        .search-wrapper {
            position: relative;
            width: 100%;
            max-width: 400px;
        }

        .search-wrapper svg {
            position: absolute;
            left: 10px;
            top: 50%;
            transform: translateY(-50%);
            width: 14px;
            height: 14px;
            color: var(--text-muted);
            pointer-events: none;
        }

        .top-bar-right {
            display: flex;
            align-items: center;
            gap: 4px;
        }

        /* =============================================================================
           ICON BUTTON
           ============================================================================= */
        .icon-button {
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            border-radius: 4px;
            background: transparent;
            border: none;
            color: var(--text-secondary);
            transition: background-color 150ms ease-in-out;
        }

        .icon-button:hover {
            background-color: var(--bg-tertiary);
        }

        .icon-button:focus-visible {
            outline: 2px solid var(--color-primary);
            outline-offset: 1px;
        }

        /* =============================================================================
           THEME SELECTOR
           ============================================================================= */
        .theme-selector {
            position: relative;
        }

        .theme-dropdown {
            position: absolute;
            top: 40px;
            right: 0;
            background-color: var(--bg-secondary);
            border: 1px solid var(--border-subtle);
            border-radius: 6px;
            box-shadow: var(--shadow-modal);
            min-width: 180px;
            z-index: 2000;
            display: none;
            overflow: hidden;
        }

        .theme-dropdown.open {
            display: block;
        }

        .theme-option {
            display: flex;
            align-items: center;
            gap: 10px;
            width: 100%;
            padding: 10px 16px;
            border: none;
            background: transparent;
            color: var(--text-secondary);
            font-size: 13px;
            font-family: inherit;
            cursor: pointer;
            transition: background-color 150ms ease-in-out;
        }

        .theme-option:hover {
            background-color: var(--bg-tertiary);
        }

        .theme-option.active {
            color: var(--color-primary);
            font-weight: 600;
        }

        .theme-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            flex-shrink: 0;
            border: 1px solid var(--border-subtle);
        }

        /* =============================================================================
           SIDENAV — 240px expanded / 64px collapsed
           ============================================================================= */
        .side-nav {
            position: fixed;
            top: 48px;
            left: 0;
            bottom: 0;
            background-color: var(--bg-secondary);
            border-right: 1px solid var(--border-subtle);
            width: 240px;
            overflow-x: hidden;
            overflow-y: auto;
            transition: width 180ms ease-in-out;
            z-index: 900;
        }

        .side-nav.collapsed {
            width: 64px;
        }

        .side-nav::-webkit-scrollbar {
            width: 4px;
        }

        .side-nav::-webkit-scrollbar-track {
            background: transparent;
        }

        .side-nav::-webkit-scrollbar-thumb {
            background-color: var(--border-subtle);
            border-radius: 2px;
        }

        .nav-list {
            padding: 4px 0;
        }

        .nav-group-label {
            padding: 16px 16px 4px;
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: var(--text-muted);
            white-space: nowrap;
            overflow: hidden;
        }

        .side-nav.collapsed .nav-group-label {
            display: none;
        }

        .nav-item {
            display: flex;
            align-items: center;
            height: 36px;
            padding: 0 16px;
            cursor: pointer;
            color: var(--text-secondary);
            background: transparent;
            border: none;
            width: 100%;
            text-align: left;
            position: relative;
            font-family: inherit;
            font-size: 13px;
            transition: background-color 150ms ease-in-out;
        }

        .nav-item:hover {
            background-color: var(--bg-tertiary);
        }

        .nav-item:focus-visible {
            outline: 2px solid var(--color-primary);
            outline-offset: -2px;
        }

        .nav-item.active {
            color: var(--color-primary);
            background-color: var(--bg-tertiary);
        }

        .nav-item.active::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 3px;
            background-color: var(--color-primary);
        }

        .nav-icon {
            width: 20px;
            height: 20px;
            flex-shrink: 0;
        }

        .nav-label {
            margin-left: 12px;
            white-space: nowrap;
            overflow: hidden;
        }

        .side-nav.collapsed .nav-label {
            display: none;
        }

        .nav-divider {
            height: 1px;
            background-color: var(--border-subtle);
            margin: 4px 16px;
        }

        /* =============================================================================
           CONTENT AREA
           ============================================================================= */
        .content-area {
            position: fixed;
            top: 48px;
            left: 240px;
            right: 0;
            bottom: 0;
            background-color: var(--bg-primary);
            padding: 24px;
            overflow-y: auto;
            transition: left 180ms ease-in-out;
        }

        .content-area.nav-collapsed {
            left: 64px;
        }

        .content-area::-webkit-scrollbar {
            width: 8px;
        }

        .content-area::-webkit-scrollbar-track {
            background: transparent;
        }

        .content-area::-webkit-scrollbar-thumb {
            background-color: var(--border-subtle);
            border-radius: 4px;
        }

        /* =============================================================================
           PAGE CONTENT & TRANSITIONS
           ============================================================================= */
        .page-content {
            display: none;
            flex-direction: column;
            gap: 20px;
            animation: pageIn 200ms ease-out;
        }

        .page-content.page-active {
            display: flex;
        }

        @keyframes pageIn {
            from { opacity: 0; transform: translateY(4px); }
            to   { opacity: 1; transform: translateY(0); }
        }

        /* =============================================================================
           SECTION HEADER
           ============================================================================= */
        .section-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 16px;
        }

        .section-header-left {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .section-title {
            font-size: 20px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .section-subtitle {
            font-size: 14px;
            color: var(--text-muted);
        }

        /* =============================================================================
           CARDS
           ============================================================================= */
        .card-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
        }

        .card {
            background-color: var(--bg-secondary);
            border-radius: 6px;
            border: 1px solid var(--border-subtle);
            padding: 20px;
            box-shadow: var(--shadow-card);
        }

        .card h3 {
            color: var(--text-primary);
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .card p {
            color: var(--text-secondary);
            font-size: 14px;
            line-height: 1.6;
            margin-bottom: 8px;
        }

        /* Stat Cards with colored left accent */
        .stat-card {
            border-left: 3px solid var(--stat-accent, var(--color-primary));
        }

        .stat-card .stat-value {
            font-size: 28px;
            font-weight: 600;
            color: var(--text-primary);
            line-height: 1.2;
            margin-bottom: 4px;
        }

        .stat-card .stat-label {
            font-size: 12px;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.3px;
        }

        /* =============================================================================
           VERSION BADGE
           ============================================================================= */
        .version-badge {
            display: inline-flex;
            align-items: center;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 600;
            background-color: color-mix(in srgb, var(--color-primary) 15%, transparent);
            color: var(--color-primary);
            border: 1px solid color-mix(in srgb, var(--color-primary) 30%, transparent);
        }

        /* =============================================================================
           BADGES
           ============================================================================= */
        .badge {
            display: inline-flex;
            align-items: center;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
            white-space: nowrap;
        }

        .badge-success {
            background-color: color-mix(in srgb, var(--color-success) 15%, transparent);
            color: var(--color-success);
            border: 1px solid color-mix(in srgb, var(--color-success) 30%, transparent);
        }

        .badge-info {
            background-color: color-mix(in srgb, var(--color-primary) 15%, transparent);
            color: var(--color-primary);
            border: 1px solid color-mix(in srgb, var(--color-primary) 30%, transparent);
        }

        .badge-warning {
            background-color: color-mix(in srgb, var(--color-warning) 15%, transparent);
            color: var(--color-warning);
            border: 1px solid color-mix(in srgb, var(--color-warning) 30%, transparent);
        }

        .badge-danger {
            background-color: color-mix(in srgb, var(--color-danger) 15%, transparent);
            color: var(--color-danger);
            border: 1px solid color-mix(in srgb, var(--color-danger) 30%, transparent);
        }

        /* =============================================================================
           PRIORITY INDICATORS
           ============================================================================= */
        .priority-high {
            color: var(--color-danger);
            font-weight: 600;
        }

        .priority-normal {
            color: var(--text-secondary);
        }

        .priority-low {
            color: var(--color-success);
        }

        /* =============================================================================
           GRID TOOLBAR (D365 Command Bar)
           ============================================================================= */
        .grid-toolbar {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 0;
            border-bottom: 1px solid var(--border-subtle);
            flex-wrap: wrap;
        }

        .grid-toolbar .button {
            padding: 6px 12px;
            font-size: 13px;
            font-weight: 500;
        }

        .grid-search {
            flex: 0 1 260px;
            margin-left: auto;
            padding: 6px 12px;
            font-size: 13px;
            font-family: inherit;
            border: 1px solid var(--border-subtle);
            border-radius: 4px;
            background-color: var(--bg-primary);
            color: var(--text-primary);
            outline: none;
            transition: border-color 150ms ease-in-out;
        }

        .grid-search::placeholder {
            color: var(--text-muted);
        }

        .grid-search:focus {
            border-color: var(--color-primary);
        }

        /* =============================================================================
           TABLE / DATA GRID
           ============================================================================= */
        .table-wrapper {
            overflow-x: auto;
        }

        .table {
            width: 100%;
            border-collapse: collapse;
        }

        .table thead {
            border-bottom: 1px solid var(--border-subtle);
        }

        .table th {
            text-align: left;
            padding: 10px 12px;
            font-weight: 600;
            color: var(--text-primary);
            font-size: 13px;
            white-space: nowrap;
            user-select: none;
        }

        .table td {
            padding: 10px 12px;
            color: var(--text-secondary);
            font-size: 13px;
            border-top: 1px solid var(--border-subtle);
        }

        .table tbody tr {
            transition: background-color 150ms ease-in-out;
        }

        .table tbody tr:hover {
            background-color: var(--bg-tertiary);
        }

        .table tbody tr.clickable-row {
            cursor: pointer;
        }

        .table tbody tr.clickable-row:active {
            background-color: color-mix(in srgb, var(--color-primary) 8%, var(--bg-tertiary));
        }

        .table td .tool-name {
            color: var(--color-primary);
            font-weight: 500;
        }

        /* Grid Footer */
        .grid-footer {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 8px 12px;
            font-size: 12px;
            color: var(--text-muted);
            border-top: 1px solid var(--border-subtle);
        }

        /* =============================================================================
           BUTTONS
           ============================================================================= */
        .button {
            padding: 8px 16px;
            border-radius: 4px;
            border: none;
            font-size: 14px;
            font-weight: 600;
            font-family: inherit;
            cursor: pointer;
            transition: all 150ms ease-in-out;
            display: inline-flex;
            align-items: center;
            gap: 6px;
        }

        .button:focus-visible {
            outline: 2px solid var(--color-primary);
            outline-offset: 1px;
        }

        .button-primary {
            background-color: var(--color-primary);
            color: white;
        }

        .button-primary:hover {
            filter: brightness(0.9);
        }

        .button-outline {
            background-color: transparent;
            color: var(--text-primary);
            border: 1px solid var(--border-subtle);
        }

        .button-outline:hover {
            background-color: var(--bg-tertiary);
        }

        .button-sm {
            padding: 6px 12px;
            font-size: 13px;
            font-weight: 500;
        }

        .button-group {
            display: flex;
            gap: 8px;
        }

        /* =============================================================================
           DETAIL PAGE
           ============================================================================= */
        .detail-header {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .back-button {
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            border-radius: 4px;
            background: transparent;
            border: none;
            color: var(--text-secondary);
            transition: background-color 150ms ease-in-out;
            flex-shrink: 0;
        }

        .back-button:hover {
            background-color: var(--bg-tertiary);
        }

        .back-button:focus-visible {
            outline: 2px solid var(--color-primary);
            outline-offset: 1px;
        }

        .detail-meta {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 16px;
        }

        .meta-item {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .meta-label {
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: var(--text-muted);
        }

        .meta-value {
            font-size: 14px;
            color: var(--text-primary);
        }

        .meta-value a {
            color: var(--color-primary);
            text-decoration: none;
        }

        .meta-value a:hover {
            text-decoration: underline;
        }

        .detail-body {
            font-size: 14px;
            line-height: 1.8;
            color: var(--text-secondary);
            white-space: pre-line;
        }

        .tag-list {
            display: flex;
            gap: 6px;
            flex-wrap: wrap;
        }

        .tag {
            display: inline-block;
            padding: 2px 10px;
            border-radius: 12px;
            font-size: 12px;
            background-color: var(--bg-tertiary);
            color: var(--text-secondary);
            border: 1px solid var(--border-subtle);
        }

        /* =============================================================================
           SPECKKIT PAGE
           ============================================================================= */
        .sk-feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
            gap: 16px;
        }

        .sk-feature-card {
            background-color: var(--bg-secondary);
            border-radius: 6px;
            border: 1px solid var(--border-subtle);
            padding: 20px;
            box-shadow: var(--shadow-card);
        }

        .sk-feature-card .sk-icon {
            width: 36px;
            height: 36px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 12px;
            color: white;
        }

        .sk-feature-card .sk-icon svg {
            width: 20px;
            height: 20px;
        }

        .sk-feature-card h3 {
            font-size: 15px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 6px;
        }

        .sk-feature-card p {
            font-size: 13px;
            line-height: 1.6;
            color: var(--text-secondary);
        }

        .sk-feature-card .sk-status {
            margin-top: 12px;
            font-size: 12px;
            font-weight: 600;
        }

        /* =============================================================================
           SCREENSHOT GALLERY — Adaptive layout for 1–5 images
           ============================================================================= */
        .gallery-section {
            display: none;
        }

        .gallery-section.has-screenshots {
            display: block;
        }

        .screenshot-gallery {
            display: grid;
            gap: 12px;
            margin-top: 12px;
        }

        /* 1 image: full width */
        .screenshot-gallery[data-count="1"] {
            grid-template-columns: 1fr;
        }

        /* 2 images: equal columns */
        .screenshot-gallery[data-count="2"] {
            grid-template-columns: 1fr 1fr;
        }

        /* 3 images: first full-width, next 2 split */
        .screenshot-gallery[data-count="3"] {
            grid-template-columns: 1fr 1fr;
        }

        .screenshot-gallery[data-count="3"] .gallery-item:first-child {
            grid-column: 1 / -1;
        }

        /* 4 images: 2x2 grid */
        .screenshot-gallery[data-count="4"] {
            grid-template-columns: 1fr 1fr;
        }

        /* 5 images: first full-width, then 2x2 */
        .screenshot-gallery[data-count="5"] {
            grid-template-columns: 1fr 1fr;
        }

        .screenshot-gallery[data-count="5"] .gallery-item:first-child {
            grid-column: 1 / -1;
        }

        .gallery-item {
            position: relative;
            border-radius: 6px;
            overflow: hidden;
            border: 1px solid var(--border-subtle);
            cursor: pointer;
            transition: border-color 150ms ease-in-out, box-shadow 150ms ease-in-out;
            background-color: var(--bg-tertiary);
        }

        .gallery-item:hover {
            border-color: var(--color-primary);
            box-shadow: 0 0 0 1px var(--color-primary);
        }

        .gallery-item:focus-visible {
            outline: 2px solid var(--color-primary);
            outline-offset: 2px;
        }

        .gallery-item img,
        .gallery-item video {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block;
            aspect-ratio: 16 / 9;
        }

        /* Single image gets more height */
        .screenshot-gallery[data-count="1"] .gallery-item img,
        .screenshot-gallery[data-count="1"] .gallery-item video {
            aspect-ratio: 16 / 8;
            max-height: 480px;
            object-fit: contain;
            background-color: var(--bg-tertiary);
        }

        /* Full-width hero in 3/5 layout */
        .screenshot-gallery[data-count="3"] .gallery-item:first-child img,
        .screenshot-gallery[data-count="3"] .gallery-item:first-child video,
        .screenshot-gallery[data-count="5"] .gallery-item:first-child img,
        .screenshot-gallery[data-count="5"] .gallery-item:first-child video {
            aspect-ratio: 16 / 7;
            max-height: 400px;
            object-fit: contain;
            background-color: var(--bg-tertiary);
        }

        /* Gallery item index badge */
        .gallery-index {
            position: absolute;
            bottom: 8px;
            right: 8px;
            background-color: var(--bg-secondary);
            color: var(--text-muted);
            font-size: 11px;
            font-weight: 600;
            padding: 2px 8px;
            border-radius: 4px;
            border: 1px solid var(--border-subtle);
            opacity: 0;
            transition: opacity 150ms ease-in-out;
            pointer-events: none;
        }

        .gallery-item:hover .gallery-index {
            opacity: 1;
        }

        /* Expand icon overlay */
        .gallery-expand {
            position: absolute;
            top: 8px;
            right: 8px;
            width: 28px;
            height: 28px;
            background-color: var(--bg-secondary);
            border: 1px solid var(--border-subtle);
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transition: opacity 150ms ease-in-out;
            pointer-events: none;
            color: var(--text-secondary);
        }

        .gallery-item:hover .gallery-expand {
            opacity: 1;
        }

        /* No screenshots placeholder */
        .gallery-empty {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 48px 24px;
            color: var(--text-muted);
            font-size: 13px;
            border: 2px dashed var(--border-subtle);
            border-radius: 6px;
            margin-top: 12px;
        }

        .gallery-empty svg {
            width: 20px;
            height: 20px;
            margin-right: 8px;
            opacity: 0.5;
        }

        /* =============================================================================
           LIGHTBOX / MODAL — Full-screen image viewer
           ============================================================================= */
        .lightbox {
            display: none;
            position: fixed;
            inset: 0;
            z-index: 5000;
            background-color: rgba(0, 0, 0, 0.85);
            align-items: center;
            justify-content: center;
            padding: 48px;
            cursor: pointer;
        }

        .lightbox.open {
            display: flex;
        }

        .lightbox-content {
            position: relative;
            max-width: 100%;
            max-height: 100%;
            cursor: default;
        }

        .lightbox-content img,
        .lightbox-content video {
            max-width: 90vw;
            max-height: 85vh;
            object-fit: contain;
            border-radius: 6px;
            box-shadow: 0 16px 48px rgba(0, 0, 0, 0.6);
        }

        .lightbox-close {
            position: fixed;
            top: 16px;
            right: 16px;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: var(--bg-secondary);
            border: 1px solid var(--border-subtle);
            border-radius: 6px;
            cursor: pointer;
            color: var(--text-primary);
            z-index: 5001;
            transition: background-color 150ms ease-in-out;
        }

        .lightbox-close:hover {
            background-color: var(--bg-tertiary);
        }

        .lightbox-nav {
            position: fixed;
            top: 50%;
            transform: translateY(-50%);
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: var(--bg-secondary);
            border: 1px solid var(--border-subtle);
            border-radius: 6px;
            cursor: pointer;
            color: var(--text-primary);
            z-index: 5001;
            transition: background-color 150ms ease-in-out;
        }

        .lightbox-nav:hover {
            background-color: var(--bg-tertiary);
        }

        .lightbox-prev {
            left: 16px;
        }

        .lightbox-next {
            right: 16px;
        }

        .lightbox-counter {
            position: fixed;
            bottom: 16px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 13px;
            color: var(--text-muted);
            background-color: var(--bg-secondary);
            padding: 4px 16px;
            border-radius: 20px;
            border: 1px solid var(--border-subtle);
            z-index: 5001;
        }

        /* =============================================================================
           SVG ICON SIZE
           ============================================================================= */
        .icon {
            width: 20px;
            height: 20px;
        }

        .icon-lg {
            width: 24px;
            height: 24px;
        }
    </style>
</head>
<body class="theme-dark">
    <!-- ================================================================
         TOPBAR
         ================================================================ -->
    <div class="top-bar">
        <div class="top-bar-left">
            <button class="icon-button" onclick="toggleNav()" aria-label="Toggle navigation">
                <svg class="icon" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M3 6h18v2H3V6zm0 5h18v2H3v-2zm0 5h18v2H3v-2z"/>
                </svg>
            </button>
            <div class="top-bar-title">D365 Modern Shell</div>
        </div>
        <div class="top-bar-center">
            <div class="search-wrapper">
                <svg viewBox="0 0 24 24" fill="currentColor"><path d="M15.5 14h-.79l-.28-.27A6.471 6.471 0 0 0 16 9.5 6.5 6.5 0 1 0 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/></svg>
                <input type="text" class="top-bar-search" placeholder="Search tools..." id="globalSearch" oninput="filterToolsGrid()" />
            </div>
        </div>
        <div class="top-bar-right">
            <button class="icon-button" aria-label="Notifications">
                <svg class="icon" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M12 22c1.1 0 2-.9 2-2h-4a2 2 0 0 0 2 2zm6-6v-5c0-3.07-1.63-5.64-4.5-6.32V4c0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5v.68C7.64 5.36 6 7.92 6 11v5l-2 2v1h16v-1l-2-2zm-2 1H8v-6c0-2.48 1.51-4.5 4-4.5s4 2.02 4 4.5v6z"/>
                </svg>
            </button>
            <div class="theme-selector">
                <button class="icon-button" onclick="toggleThemeDropdown()" aria-label="Change theme">
                    <svg class="icon theme-icon" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M12 3a9 9 0 1 0 9 9c0-.46-.04-.92-.1-1.36a5.389 5.389 0 0 1-4.4 2.26 5.403 5.403 0 0 1-3.14-9.8c-.44-.06-.9-.1-1.36-.1z"/>
                    </svg>
                </button>
                <div class="theme-dropdown" id="themeDropdown">
                    <button class="theme-option active" onclick="setTheme('theme-dark')">
                        <span class="theme-dot" style="background: #0B0D10;"></span>
                        Circuit Dark
                    </button>
                    <button class="theme-option" onclick="setTheme('theme-light')">
                        <span class="theme-dot" style="background: #F4F7FA;"></span>
                        Circuit Light
                    </button>
                    <button class="theme-option" onclick="setTheme('theme-d365')">
                        <span class="theme-dot" style="background: #0078D4;"></span>
                        Dynamics 365
                    </button>
                </div>
            </div>
            <button class="icon-button" aria-label="User profile">
                <svg class="icon" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2a7.2 7.2 0 0 1-6-3.22c.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08a7.2 7.2 0 0 1-6 3.22z"/>
                </svg>
            </button>
        </div>
    </div>

    <!-- ================================================================
         SIDENAV
         ================================================================ -->
    <nav class="side-nav" id="sideNav">
        <ul class="nav-list">
            <!-- OVERVIEW -->
            <li class="nav-group-label">Overview</li>
            <li>
                <button class="nav-item active" data-page="dashboard">
                    <svg class="nav-icon" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M3 13h8V3H3v10zm0 8h8v-6H3v6zm10 0h8V11h-8v10zm0-18v6h8V3h-8z"/>
                    </svg>
                    <span class="nav-label">Dashboard</span>
                </button>
            </li>
            <li>
                <button class="nav-item" data-page="speckkit">
                    <svg class="nav-icon" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4zm-2 16l-4-4 1.41-1.41L10 14.17l6.59-6.59L18 9l-8 8z"/>
                    </svg>
                    <span class="nav-label">SpeckKit</span>
                </button>
            </li>

            <li><div class="nav-divider"></div></li>

            <!-- GENERIC TOOLS -->
            <li class="nav-group-label">Generic Tools</li>
            <li>
                <button class="nav-item" data-tool="generic-sidebar">
                    <svg class="nav-icon" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M3 3h18v18H3V3zm2 2v14h4V5H5zm6 0v14h8V5h-8z"/>
                    </svg>
                    <span class="nav-label">Generic Sidebar</span>
                </button>
            </li>
            <li>
                <button class="nav-item" data-tool="copilot-studio-budgetary-cost-estimator">
                    <svg class="nav-icon" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M11.8 10.9c-2.27-.59-3-1.2-3-2.15 0-1.09 1.01-1.85 2.7-1.85 1.78 0 2.44.85 2.5 2.1h2.21c-.07-1.72-1.12-3.3-3.21-3.81V3h-3v2.16c-1.94.42-3.5 1.68-3.5 3.61 0 2.31 1.91 3.46 4.7 4.13 2.5.6 3 1.48 3 2.41 0 .69-.49 1.79-2.7 1.79-2.06 0-2.87-.92-2.98-2.1h-2.2c.12 2.19 1.76 3.42 3.68 3.83V21h3v-2.15c1.95-.37 3.5-1.5 3.5-3.55 0-2.84-2.43-3.81-4.7-4.4z"/>
                    </svg>
                    <span class="nav-label">Cost Estimator</span>
                </button>
            </li>
            <li>
                <button class="nav-item" data-tool="teleprompter">
                    <svg class="nav-icon" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M20 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 14H4V6h16v12zM6 10h2v2H6v-2zm0 4h8v2H6v-2zm10 0h2v2h-2v-2zm-6-4h8v2h-8v-2z"/>
                    </svg>
                    <span class="nav-label">Teleprompter</span>
                </button>
            </li>
            <li>
                <button class="nav-item" data-tool="contact-center-mcp">
                    <svg class="nav-icon" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 14H5.17L4 17.17V4h16v12zM7 9h2v2H7V9zm4 0h2v2h-2V9zm4 0h2v2h-2V9z"/>
                    </svg>
                    <span class="nav-label">Contact Center MCP</span>
                </button>
            </li>

            <li><div class="nav-divider"></div></li>

            <!-- PUBLICATIONS -->
            <li class="nav-group-label">Publications</li>
            <li>
                <button class="nav-item" data-tool="dynamics-contact-center-whitepaper">
                    <svg class="nav-icon" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M14 2H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V8l-6-6zM6 20V4h7v5h5v11H6zm2-6h8v2H8v-2zm0-3h8v2H8v-2z"/>
                    </svg>
                    <span class="nav-label">CC White Paper</span>
                </button>
            </li>

            <li><div class="nav-divider"></div></li>

            <!-- DEVELOPMENT -->
            <li class="nav-group-label">Development</li>
            <li>
                <button class="nav-item" data-tool="snippets">
                    <svg class="nav-icon" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M9.4 16.6L4.8 12l4.6-4.6L8 6l-6 6 6 6 1.4-1.4zm5.2 0l4.6-4.6-4.6-4.6L16 6l6 6-6 6-1.4-1.4z"/>
                    </svg>
                    <span class="nav-label">Snippets</span>
                </button>
            </li>
            <li>
                <button class="nav-item" data-tool="powerbi">
                    <svg class="nav-icon" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
                    </svg>
                    <span class="nav-label">Power BI</span>
                </button>
            </li>
            <li>
                <button class="nav-item" data-tool="speckkit-project-development">
                    <svg class="nav-icon" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58a.49.49 0 0 0 .12-.61l-1.92-3.32a.488.488 0 0 0-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54a.484.484 0 0 0-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.05.3-.07.62-.07.94s.02.64.07.94l-2.03 1.58a.49.49 0 0 0-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6A3.6 3.6 0 1 1 12 8.4a3.6 3.6 0 0 1 0 7.2z"/>
                    </svg>
                    <span class="nav-label">SpeckKit Dev</span>
                </button>
            </li>
        </ul>
    </nav>

    <!-- ================================================================
         CONTENT AREA
         ================================================================ -->
    <main class="content-area" id="contentArea">

        <!-- ============================================================
             DASHBOARD PAGE
             ============================================================ -->
        <div id="page-dashboard" class="page-content page-active">
            <div class="section-header">
                <div class="section-header-left">
                    <h2 class="section-title">Tool Portfolio</h2>
                    <span class="version-badge">v1.0.0</span>
                </div>
            </div>

            <!-- Stat Cards -->
            <div class="card-grid" style="grid-template-columns: repeat(4, 1fr);">
                <div class="card stat-card" style="--stat-accent: var(--color-primary);">
                    <div class="stat-value">8</div>
                    <div class="stat-label">Total Tools</div>
                </div>
                <div class="card stat-card" style="--stat-accent: var(--color-success);">
                    <div class="stat-value">8</div>
                    <div class="stat-label">Active</div>
                </div>
                <div class="card stat-card" style="--stat-accent: var(--color-accent);">
                    <div class="stat-value">4</div>
                    <div class="stat-label">Categories</div>
                </div>
                <div class="card stat-card" style="--stat-accent: var(--color-warning);">
                    <div class="stat-value">3</div>
                    <div class="stat-label">High Priority</div>
                </div>
            </div>

            <!-- Tools Grid -->
            <div class="card" style="padding: 0;">
                <div class="grid-toolbar" style="padding: 8px 16px;">
                    <button class="button button-primary button-sm">
                        <svg class="icon" viewBox="0 0 24 24" fill="currentColor" style="width:16px;height:16px;"><path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/></svg>
                        New Tool
                    </button>
                    <button class="button button-outline button-sm" onclick="renderToolsGrid()">
                        <svg class="icon" viewBox="0 0 24 24" fill="currentColor" style="width:14px;height:14px;"><path d="M17.65 6.35A7.958 7.958 0 0 0 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08A5.99 5.99 0 0 1 12 18c-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"/></svg>
                        Refresh
                    </button>
                    <input type="text" class="grid-search" placeholder="Filter tools..." id="gridSearch" oninput="filterToolsGrid()" />
                </div>
                <div class="table-wrapper">
                    <table class="table" id="toolsTable">
                        <thead>
                            <tr>
                                <th>Tool Name</th>
                                <th>Category</th>
                                <th>Status</th>
                                <th>Priority</th>
                                <th>Last Updated</th>
                            </tr>
                        </thead>
                        <tbody id="toolsTableBody">
                            <!-- Rendered by JS -->
                        </tbody>
                    </table>
                </div>
                <div class="grid-footer" id="gridFooter">
                    <span>1–8 of 8 tools</span>
                    <span>Page 1</span>
                </div>
            </div>
        </div>

        <!-- ============================================================
             TOOL DETAIL PAGE
             ============================================================ -->
        <div id="page-tool-detail" class="page-content">
            <div class="detail-header">
                <button class="back-button" onclick="showPage('dashboard')" aria-label="Back to dashboard">
                    <svg class="icon" viewBox="0 0 24 24" fill="currentColor"><path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/></svg>
                </button>
                <h2 class="section-title" id="detailTitle">Tool Name</h2>
            </div>

            <div class="card">
                <div class="detail-meta" id="detailMeta">
                    <!-- Rendered by JS -->
                </div>
            </div>

            <div class="card">
                <h3>Description</h3>
                <div class="detail-body" id="detailDescription"></div>
            </div>

            <div class="card">
                <h3>Tags</h3>
                <div class="tag-list" id="detailTags"></div>
            </div>

            <!-- Screenshot Gallery -->
            <div class="card gallery-section" id="gallerySection">
                <div style="display: flex; align-items: center; justify-content: space-between;">
                    <h3>Screenshots</h3>
                    <span id="galleryCount" style="font-size: 12px; color: var(--text-muted);"></span>
                </div>
                <div class="screenshot-gallery" id="screenshotGallery" data-count="0">
                    <!-- Rendered by JS -->
                </div>
            </div>

            <div class="button-group" id="detailActions">
                <!-- Rendered by JS -->
            </div>
        </div>

        <!-- ============================================================
             SPECKKIT PAGE
             ============================================================ -->
        <div id="page-speckkit" class="page-content">
            <div class="section-header">
                <div class="section-header-left">
                    <h2 class="section-title">SpeckKit Project Development</h2>
                    <span class="badge badge-success">Active</span>
                </div>
            </div>

            <div class="card">
                <p style="margin-bottom: 0;">
                    SpeckKit is a centralized governance registry that provides code standards, component header templates, UI reference models, and agent behavior defaults for all projects in the portfolio. It enforces consistency through Git submodules, auto-applied code standards, and structured UI reference catalogs.
                </p>
            </div>

            <div class="sk-feature-grid">
                <div class="sk-feature-card">
                    <div class="sk-icon" style="background-color: var(--color-success);">
                        <svg viewBox="0 0 24 24" fill="currentColor"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z"/></svg>
                    </div>
                    <h3>Code Standards</h3>
                    <p>Structured comment headers for every component file. Auto-applied by default — no configuration required.</p>
                    <div class="sk-status" style="color: var(--color-success);">Auto-Applied</div>
                </div>
                <div class="sk-feature-card">
                    <div class="sk-icon" style="background-color: var(--color-primary);">
                        <svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
                    </div>
                    <h3>UI References</h3>
                    <p>Platform-specific UI description models. Available for Dynamics 365 layouts, grids, and Copilot panels.</p>
                    <div class="sk-status" style="color: var(--color-primary);">Available on Request</div>
                </div>
                <div class="sk-feature-card">
                    <div class="sk-icon" style="background-color: var(--color-accent);">
                        <svg viewBox="0 0 24 24" fill="currentColor"><path d="M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58a.49.49 0 0 0 .12-.61l-1.92-3.32a.488.488 0 0 0-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54a.484.484 0 0 0-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.05.3-.07.62-.07.94s.02.64.07.94l-2.03 1.58a.49.49 0 0 0-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6A3.6 3.6 0 1 1 12 8.4a3.6 3.6 0 0 1 0 7.2z"/></svg>
                    </div>
                    <h3>Agent Behavior</h3>
                    <p>Configurable defaults for AI coding assistants. Defines auto-apply vs. ask-first behavior for all resources.</p>
                    <div class="sk-status" style="color: var(--color-accent);">Configured</div>
                </div>
            </div>

            <div class="card">
                <h3>Registry</h3>
                <p style="margin-bottom: 12px;">All projects in the portfolio reference SpeckKit for engineering standards, component documentation, and UI patterns.</p>
                <a href="https://github.com/bradlaw76/SpeckKit-Project-Development" target="_blank" rel="noopener noreferrer" class="button button-primary button-sm">
                    <svg class="icon" viewBox="0 0 24 24" fill="currentColor" style="width:14px;height:14px;"><path d="M19 19H5V5h7V3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14c1.1 0 2-.9 2-2v-7h-2v7zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3h-7z"/></svg>
                    View Registry
                </a>
            </div>
        </div>

    </main>

    <!-- ================================================================
         LIGHTBOX
         ================================================================ -->
    <div class="lightbox" id="lightbox" onclick="closeLightbox(event)">
        <button class="lightbox-close" onclick="closeLightbox()" aria-label="Close">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
        <button class="lightbox-nav lightbox-prev" onclick="lightboxNav(-1, event)" aria-label="Previous">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12l4.58-4.59z"/></svg>
        </button>
        <button class="lightbox-nav lightbox-next" onclick="lightboxNav(1, event)" aria-label="Next">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6-6-6z"/></svg>
        </button>
        <div class="lightbox-content" id="lightboxContent"></div>
        <div class="lightbox-counter" id="lightboxCounter"></div>
    </div>

    <!-- ================================================================
         JAVASCRIPT
         ================================================================ -->
    <script>
        /* ─────────────────────────────────────────────────────────────
           TOOLS DATA (from tools.json)
           ───────────────────────────────────────────────────────────── */
        const TOOLS_DATA = [
            {
                id: "generic-sidebar",
                name: "Generic Sidebar",
                version: "1.0.0",
                status: "Active",
                priority: "Normal",
                category: "Generic Tools",
                description: "A reusable, collapsible sidebar navigation component designed for Dynamics 365 model-driven apps and Power Pages.",
                longDescription: "Generic.Sidebar is a standalone navigation component that replicates the Dynamics 365 sidebar pattern. It supports collapsible groups, active state indicators, and theme-aware styling. Built with vanilla HTML/CSS/JS for maximum portability across projects.\n\nKey features include:\n- Collapsible navigation groups\n- Active route highlighting with left-edge indicator\n- Theme-aware (dark/light/D365 modes)\n- Zero dependencies \u2014 drop-in ready\n- Responsive collapse to icon-only mode at 64px",
                repoUrl: "https://github.com/bradlaw76/Generic.Sidebar",
                screenshots: [],
                tags: ["Navigation", "UI Component", "Dynamics 365"],
                dateCreated: "2025-09-23",
                lastUpdated: "2025-09-23",
                origin: "Web"
            },
            {
                id: "copilot-studio-budgetary-cost-estimator",
                name: "Copilot Studio Budgetary Cost Estimator",
                version: "1.0.0",
                status: "Active",
                priority: "High",
                category: "Generic Tools",
                description: "An interactive cost estimation tool for Microsoft Copilot Studio deployments.",
                longDescription: "The Copilot Studio Budgetary Cost Estimator provides a self-service calculator for estimating the cost of deploying Microsoft Copilot Studio agents. It factors in message volumes, channel types, generative AI usage, and licensing tiers to produce budgetary estimates.\n\nDesigned for pre-sales, solution architects, and project managers who need quick cost scoping without deep licensing expertise.",
                repoUrl: "https://github.com/bradlaw76/CopilotStudioBedgetaryCostEstimator",
                screenshots: [],
                tags: ["Copilot Studio", "Cost Estimation", "Licensing"],
                dateCreated: "2025-02-01",
                lastUpdated: "2026-02-02",
                origin: "Web"
            },
            {
                id: "teleprompter",
                name: "Teleprompter",
                version: "1.0.0",
                status: "Active",
                priority: "Normal",
                category: "Generic Tools",
                description: "A browser-based teleprompter application for presentations, demos, and video recordings.",
                longDescription: "A lightweight, browser-based teleprompter tool built for demo recordings and presentation delivery. Features adjustable scroll speed, font sizing, text mirroring (for physical teleprompter rigs), and keyboard controls.\n\nNo installation required \u2014 runs directly in any modern browser. Designed for quick use during customer demos and internal training recordings.",
                repoUrl: "https://github.com/bradlaw76/Teleprompter",
                screenshots: [],
                tags: ["Productivity", "Presentations", "Demo Tools"],
                dateCreated: "2025-10-03",
                lastUpdated: "2025-10-03",
                origin: "Web"
            },
            {
                id: "dynamics-contact-center-whitepaper",
                name: "Dynamics Contact Center White Paper",
                version: "1.0.0",
                status: "Active",
                priority: "High",
                category: "Publications",
                description: "A comprehensive white paper on Dynamics 365 Contact Center \u2014 architecture, capabilities, and deployment guidance.",
                longDescription: "This white paper provides an in-depth overview of Microsoft Dynamics 365 Contact Center, covering the platform architecture, unified routing, Copilot integration, omnichannel capabilities, and deployment best practices.\n\nPublished as a responsive GitHub Pages site with professional formatting. Serves as a go-to reference for customers and internal stakeholders evaluating the Contact Center solution.",
                repoUrl: "https://github.com/bradlaw76/DynamicsContactCenter-WhitePaper",
                screenshots: [],
                tags: ["Dynamics 365", "Contact Center", "White Paper"],
                dateCreated: "2025-05-05",
                lastUpdated: "2025-05-05",
                origin: "Web"
            },
            {
                id: "contact-center-mcp",
                name: "Contact Center MCP",
                version: "1.0.0",
                status: "Active",
                priority: "Normal",
                category: "Generic Tools",
                description: "Model Context Protocol (MCP) integration for Dynamics 365 Contact Center.",
                longDescription: "ContactCenterMCP provides a Model Context Protocol server for Dynamics 365 Contact Center environments. It exposes contact center entities (cases, queues, agents, conversations) as MCP resources, enabling Copilot and third-party AI agents to query, summarize, and act on live contact center data.\n\nConnects to a Dynamics 365 org and provides structured context for AI-powered workflows.",
                repoUrl: "https://github.com/bradlaw76/ContactCenterMCP",
                screenshots: [],
                tags: ["MCP", "Dynamics 365", "Contact Center", "AI"],
                dateCreated: "2025-05-14",
                lastUpdated: "2025-05-14",
                origin: "Web"
            },
            {
                id: "snippets",
                name: "Snippets",
                version: "1.0.0",
                status: "Active",
                priority: "Low",
                category: "Development",
                description: "A curated collection of reusable code snippets, templates, and patterns used across projects.",
                longDescription: "A living repository of code snippets, boilerplate templates, and reusable patterns. Covers HTML/CSS/JS patterns, Power Platform formulas, API call templates, and common configuration blocks.\n\nOrganized for fast lookup during development sessions. Continuously updated as new patterns emerge from project work.",
                repoUrl: "https://github.com/bradlaw76/Snippets",
                screenshots: [],
                tags: ["Code Snippets", "Templates", "Reference"],
                dateCreated: "2025-02-09",
                lastUpdated: "2026-02-09",
                origin: "Web"
            },
            {
                id: "powerbi",
                name: "Power BI",
                version: "1.0.0",
                status: "Active",
                priority: "Normal",
                category: "Development",
                description: "Power BI reports, templates, and dashboard examples.",
                longDescription: "A collection of Power BI report templates, dashboard designs, and DAX patterns. Includes reference implementations for common business reporting scenarios.\n\nServes as a starting point for new Power BI projects and a showcase of visualization techniques.",
                repoUrl: "https://github.com/bradlaw76/PowerBi",
                screenshots: [],
                tags: ["Power BI", "Reporting", "Dashboards"],
                dateCreated: "2026-02-09",
                lastUpdated: "2026-02-09",
                origin: "Web"
            },
            {
                id: "speckkit-project-development",
                name: "SpeckKit Project Development",
                version: "1.0.0",
                status: "Active",
                priority: "High",
                category: "Development",
                description: "The SpeckKit registry \u2014 a governance framework for code standards, UI references, and spec-driven development.",
                longDescription: "SpeckKit is a centralized governance registry that provides code standards, component header templates, UI reference models, and agent behavior defaults for all projects in the portfolio.\n\nIt enforces consistency through Git submodules, auto-applied code standards, and structured UI reference catalogs. Every project in the Generic ecosystem references SpeckKit for its engineering standards.\n\nKey capabilities:\n- Component header comment block templates\n- UI reference catalog (D365 grid patterns, layout models)\n- Agent behavior defaults for AI coding assistants\n- System manifest index for project discovery",
                repoUrl: "https://github.com/bradlaw76/SpeckKit-Project-Development",
                screenshots: [],
                tags: ["Governance", "Code Standards", "SpeckKit"],
                dateCreated: "2026-02-16",
                lastUpdated: "2026-02-16",
                origin: "Web"
            }
        ];

        /* ─────────────────────────────────────────────────────────────
           THEME SYSTEM
           ───────────────────────────────────────────────────────────── */
        const THEMES = ['theme-dark', 'theme-light', 'theme-d365'];
        const THEME_ICONS = {
            'theme-dark':  '<path d="M12 3a9 9 0 1 0 9 9c0-.46-.04-.92-.1-1.36a5.389 5.389 0 0 1-4.4 2.26 5.403 5.403 0 0 1-3.14-9.8c-.44-.06-.9-.1-1.36-.1z"/>',
            'theme-light': '<path d="M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zM2 13h2c.55 0 1-.45 1-1s-.45-1-1-1H2c-.55 0-1 .45-1 1s.45 1 1 1zm18 0h2c.55 0 1-.45 1-1s-.45-1-1-1h-2c-.55 0-1 .45-1 1s.45 1 1 1zM11 2v2c0 .55.45 1 1 1s1-.45 1-1V2c0-.55-.45-1-1-1s-1 .45-1 1zm0 18v2c0 .55.45 1 1 1s1-.45 1-1v-2c0-.55-.45-1-1-1s-1 .45-1 1zM5.99 4.58a.996.996 0 0 0-1.41 0 .996.996 0 0 0 0 1.41l1.06 1.06c.39.39 1.03.39 1.41 0s.39-1.03 0-1.41L5.99 4.58zm12.37 12.37a.996.996 0 0 0-1.41 0 .996.996 0 0 0 0 1.41l1.06 1.06c.39.39 1.03.39 1.41 0a.996.996 0 0 0 0-1.41l-1.06-1.06zm1.06-10.96a.996.996 0 0 0 0-1.41.996.996 0 0 0-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06zM7.05 18.36a.996.996 0 0 0 0-1.41.996.996 0 0 0-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06z"/>',
            'theme-d365':  '<path d="M17.5 12a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"/><path d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42" stroke="currentColor" stroke-width="2" stroke-linecap="round" fill="none"/>'
        };

        function setTheme(theme) {
            THEMES.forEach(t => document.body.classList.remove(t));
            document.body.classList.add(theme);
            localStorage.setItem('theme', theme);

            const icon = document.querySelector('.theme-icon');
            if (icon) icon.innerHTML = THEME_ICONS[theme] || THEME_ICONS['theme-dark'];

            document.querySelectorAll('.theme-option').forEach(opt => {
                opt.classList.toggle('active', opt.getAttribute('onclick').includes(theme));
            });

            document.getElementById('themeDropdown').classList.remove('open');
        }

        function toggleThemeDropdown() {
            document.getElementById('themeDropdown').classList.toggle('open');
        }

        document.addEventListener('click', (e) => {
            if (!e.target.closest('.theme-selector')) {
                document.getElementById('themeDropdown')?.classList.remove('open');
            }
        });

        /* ─────────────────────────────────────────────────────────────
           NAV TOGGLE
           ───────────────────────────────────────────────────────────── */
        function toggleNav() {
            document.getElementById('sideNav').classList.toggle('collapsed');
            document.getElementById('contentArea').classList.toggle('nav-collapsed');
        }

        /* ─────────────────────────────────────────────────────────────
           PAGE NAVIGATION
           ───────────────────────────────────────────────────────────── */
        let currentPage = 'dashboard';

        function showPage(pageId, skipNavUpdate) {
            currentPage = pageId;

            // Hide all pages
            document.querySelectorAll('.page-content').forEach(p => p.classList.remove('page-active'));

            // Show target
            const target = document.getElementById('page-' + pageId);
            if (target) target.classList.add('page-active');

            // Update nav active state
            if (!skipNavUpdate) {
                document.querySelectorAll('.nav-item').forEach(item => {
                    item.classList.remove('active');
                    if (item.dataset.page === pageId) {
                        item.classList.add('active');
                    }
                });
            }

            // Scroll to top
            document.getElementById('contentArea').scrollTop = 0;
        }

        function showToolDetail(toolId) {
            const tool = TOOLS_DATA.find(t => t.id === toolId);
            if (!tool) return;

            // Title
            document.getElementById('detailTitle').textContent = tool.name;

            // Metadata
            const priorityClass = tool.priority === 'High' ? 'priority-high' : tool.priority === 'Low' ? 'priority-low' : 'priority-normal';
            document.getElementById('detailMeta').innerHTML = `
                <div class="meta-item">
                    <span class="meta-label">Version</span>
                    <span class="meta-value">${tool.version}</span>
                </div>
                <div class="meta-item">
                    <span class="meta-label">Status</span>
                    <span class="meta-value"><span class="badge badge-success">${tool.status}</span></span>
                </div>
                <div class="meta-item">
                    <span class="meta-label">Priority</span>
                    <span class="meta-value ${priorityClass}">${tool.priority}</span>
                </div>
                <div class="meta-item">
                    <span class="meta-label">Category</span>
                    <span class="meta-value">${tool.category}</span>
                </div>
                <div class="meta-item">
                    <span class="meta-label">Origin</span>
                    <span class="meta-value">${tool.origin || '\u2014'}</span>
                </div>
                <div class="meta-item">
                    <span class="meta-label">Created</span>
                    <span class="meta-value">${tool.dateCreated}</span>
                </div>
                <div class="meta-item">
                    <span class="meta-label">Last Updated</span>
                    <span class="meta-value">${tool.lastUpdated}</span>
                </div>
            `;

            // Description
            document.getElementById('detailDescription').textContent = tool.longDescription;

            // Tags
            document.getElementById('detailTags').innerHTML = tool.tags.map(t => `<span class="tag">${t}</span>`).join('');

            // Actions
            document.getElementById('detailActions').innerHTML = `
                <a href="${tool.repoUrl}" target="_blank" rel="noopener noreferrer" class="button button-primary button-sm">
                    <svg class="icon" viewBox="0 0 24 24" fill="currentColor" style="width:14px;height:14px;"><path d="M19 19H5V5h7V3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14c1.1 0 2-.9 2-2v-7h-2v7zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3h-7z"/></svg>
                    View Repository
                </a>
            `;

            // Screenshots
            renderScreenshotGallery(tool);

            // Highlight the correct nav item
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
                if (item.dataset.tool === toolId) {
                    item.classList.add('active');
                }
            });

            showPage('tool-detail', true);
        }

        /* ─────────────────────────────────────────────────────────────
           TOOLS GRID RENDERING
           ───────────────────────────────────────────────────────────── */
        function renderToolsGrid(filter) {
            const tbody = document.getElementById('toolsTableBody');
            const filterStr = (filter || '').toLowerCase();
            const filtered = TOOLS_DATA.filter(t =>
                !filterStr ||
                t.name.toLowerCase().includes(filterStr) ||
                t.category.toLowerCase().includes(filterStr) ||
                t.tags.some(tag => tag.toLowerCase().includes(filterStr))
            );

            tbody.innerHTML = filtered.map(tool => {
                const priorityClass = tool.priority === 'High' ? 'priority-high' : tool.priority === 'Low' ? 'priority-low' : 'priority-normal';
                return `
                    <tr class="clickable-row" onclick="showToolDetail('${tool.id}')">
                        <td><span class="tool-name">${tool.name}</span></td>
                        <td>${tool.category}</td>
                        <td><span class="badge badge-success">${tool.status}</span></td>
                        <td><span class="${priorityClass}">${tool.priority}</span></td>
                        <td>${tool.lastUpdated}</td>
                    </tr>
                `;
            }).join('');

            document.getElementById('gridFooter').innerHTML = `
                <span>1\u2013${filtered.length} of ${filtered.length} tool${filtered.length !== 1 ? 's' : ''}</span>
                <span>Page 1</span>
            `;
        }

        function filterToolsGrid() {
            const globalVal = document.getElementById('globalSearch').value;
            const gridVal = document.getElementById('gridSearch').value;
            const filter = gridVal || globalVal;
            renderToolsGrid(filter);
        }

        /* ─────────────────────────────────────────────────────────────
           SCREENSHOT GALLERY RENDERING
           ───────────────────────────────────────────────────────────── */
        function isVideo(src) {
            return /\.(mp4|webm|ogg)$/i.test(src);
        }

        function renderScreenshotGallery(tool) {
            const section = document.getElementById('gallerySection');
            const gallery = document.getElementById('screenshotGallery');
            const countEl = document.getElementById('galleryCount');
            const screenshots = tool.screenshots || [];

            if (screenshots.length === 0) {
                section.classList.remove('has-screenshots');
                gallery.innerHTML = '';
                countEl.textContent = '';
                return;
            }

            section.classList.add('has-screenshots');
            const count = Math.min(screenshots.length, 5);
            gallery.setAttribute('data-count', count);
            countEl.textContent = count + ' of ' + screenshots.length;

            gallery.innerHTML = screenshots.slice(0, 5).map((src, i) => {
                const mediaEl = isVideo(src)
                    ? `<video src="${src}" muted preload="metadata"></video>`
                    : `<img src="${src}" alt="${tool.name} screenshot ${i + 1}" loading="lazy" />`;

                return `
                    <div class="gallery-item" tabindex="0" onclick="openLightbox(${i})" onkeydown="if(event.key==='Enter')openLightbox(${i})" role="button" aria-label="View screenshot ${i + 1}">
                        ${mediaEl}
                        <div class="gallery-expand">
                            <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor"><path d="M21 11V3h-8l3.29 3.29-10 10L3 13v8h8l-3.29-3.29 10-10L21 11z"/></svg>
                        </div>
                        <div class="gallery-index">${i + 1} / ${count}</div>
                    </div>
                `;
            }).join('');

            // Store current screenshots for lightbox
            window._lightboxMedia = screenshots.slice(0, 5);
            window._lightboxToolName = tool.name;
        }

        /* ─────────────────────────────────────────────────────────────
           LIGHTBOX
           ───────────────────────────────────────────────────────────── */
        let lightboxIndex = 0;

        function openLightbox(index) {
            const media = window._lightboxMedia || [];
            if (!media.length) return;
            lightboxIndex = index;
            renderLightboxContent();
            document.getElementById('lightbox').classList.add('open');
            document.body.style.overflow = 'hidden';
        }

        function closeLightbox(e) {
            if (e && e.target !== e.currentTarget && !e.target.closest('.lightbox-close')) return;
            document.getElementById('lightbox').classList.remove('open');
            document.body.style.overflow = '';
            // Pause any playing video
            const vid = document.querySelector('#lightboxContent video');
            if (vid) vid.pause();
        }

        function lightboxNav(dir, e) {
            if (e) { e.stopPropagation(); e.preventDefault(); }
            const media = window._lightboxMedia || [];
            lightboxIndex = (lightboxIndex + dir + media.length) % media.length;
            renderLightboxContent();
        }

        function renderLightboxContent() {
            const media = window._lightboxMedia || [];
            const src = media[lightboxIndex];
            const container = document.getElementById('lightboxContent');
            const counter = document.getElementById('lightboxCounter');
            const name = window._lightboxToolName || 'Screenshot';

            if (isVideo(src)) {
                container.innerHTML = `<video src="${src}" controls autoplay style="max-width:90vw;max-height:85vh;border-radius:6px;box-shadow:0 16px 48px rgba(0,0,0,0.6);"></video>`;
            } else {
                container.innerHTML = `<img src="${src}" alt="${name} screenshot ${lightboxIndex + 1}" />`;
            }

            counter.textContent = `${lightboxIndex + 1} / ${media.length}`;

            // Hide nav arrows if only 1 image
            const prev = document.querySelector('.lightbox-prev');
            const next = document.querySelector('.lightbox-next');
            if (media.length <= 1) {
                prev.style.display = 'none';
                next.style.display = 'none';
                counter.style.display = 'none';
            } else {
                prev.style.display = 'flex';
                next.style.display = 'flex';
                counter.style.display = 'block';
            }
        }

        // Keyboard navigation for lightbox
        document.addEventListener('keydown', (e) => {
            const lb = document.getElementById('lightbox');
            if (!lb.classList.contains('open')) return;
            if (e.key === 'Escape') closeLightbox();
            if (e.key === 'ArrowLeft') lightboxNav(-1);
            if (e.key === 'ArrowRight') lightboxNav(1);
        });

        /* ─────────────────────────────────────────────────────────────
           NAV CLICK HANDLERS
           ───────────────────────────────────────────────────────────── */
        document.querySelectorAll('.nav-item').forEach(item => {
            item.addEventListener('click', () => {
                const pageId = item.dataset.page;
                const toolId = item.dataset.tool;

                if (pageId) {
                    showPage(pageId);
                } else if (toolId) {
                    showToolDetail(toolId);
                }
            });
        });

        /* ─────────────────────────────────────────────────────────────
           INIT
           ───────────────────────────────────────────────────────────── */
        window.addEventListener('DOMContentLoaded', () => {
            const saved = localStorage.getItem('theme') || 'theme-dark';
            setTheme(saved);
            renderToolsGrid();
        });
    </script>
</body>
</html>
